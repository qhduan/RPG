{"version":3,"sources":["src/Game/GameDrawHero.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAqBA,CAAC,YAAY;AACX,cAAY,CAAC;;;;AAIb,WAAS,gBAAgB,CAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,QAAQ,EAAE;AAC1D,QAAI,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AAC9C,UAAM,CAAC,MAAM,GAAG,MAAM,CAAC;AACvB,UAAM,CAAC,KAAK,GAAG,KAAK,CAAC;AACrB,QAAI,OAAO,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;AACtC,WAAO,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;;AAEvC,QAAI,MAAM,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;AAC/B,SAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,EAAE,CAAC,EAAE,EAAE;AAC/B,UAAI,GAAG,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;AACpB,aAAO,CAAC,SAAS,CACf,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,MAAM,EAChC,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,CACpB,CAAC;KACH;;AAED,QAAI,aAAa,GAAG,IAAI,KAAK,EAAE,CAAC;AAChC,iBAAa,CAAC,GAAG,GAAG,MAAM,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;;AAElD,WAAO,CAAC,SAAS,CACf,MAAM,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC,KAAK,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC,MAAM,EACjE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,CACpB,CAAC;;AAEF,QAAI,UAAU,GAAG,IAAI,KAAK,EAAE,CAAC;AAC7B,cAAU,CAAC,GAAG,GAAG,MAAM,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;;AAE/C,YAAQ,CAAC,CAAC,aAAa,EAAE,UAAU,CAAC,CAAC,CAAC;GACvC;;;AAGD,MAAI,CAAC,MAAM,CAAC,UAAU,EAAE,UAAU,UAAU,EAAE,QAAQ,EAAE;;AAEtD,aAAS,KAAK,CAAE,GAAG,EAAE;AACnB,UAAI,OAAO,GAAG,IAAI,QAAQ,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,EAC1C,OAAO,IAAI,CAAC;AACd,aAAO,KAAK,CAAC;KACd;;AAED,QAAI,IAAI,GAAG,MAAM,CAAC;AAClB,QAAI,SAAS,GAAG,EAAE,CAAC;;AAEnB,QAAI,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE;;;AAGnD,eAAS,CAAC,IAAI,CAAI,IAAI,cAAS,UAAU,CAAC,GAAG,SAAI,UAAU,CAAC,IAAI,UAAO,CAAC;;AAExE,UAAI,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,EACxB,SAAS,CAAC,IAAI,CAAI,IAAI,cAAS,UAAU,CAAC,GAAG,cAAS,UAAU,CAAC,IAAI,UAAO,CAAC;;AAE/E,UAAI,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC,EAC1B,SAAS,CAAC,IAAI,CAAI,IAAI,gBAAW,UAAU,CAAC,GAAG,SAAI,UAAU,CAAC,MAAM,UAAO,CAAC;AAC9E,UAAI,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,EACzB,SAAS,CAAC,IAAI,CAAI,IAAI,eAAU,UAAU,CAAC,GAAG,SAAI,UAAU,CAAC,KAAK,UAAO,CAAC;AAC5E,UAAI,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC;;AAEzB,iBAAS,CAAC,IAAI,CAAI,IAAI,eAAU,UAAU,CAAC,GAAG,SAAI,UAAU,CAAC,KAAK,UAAO,CAAC;AAC5E,UAAI,KAAK,CAAC,UAAU,CAAC,UAAU,CAAC,EAC9B,SAAS,CAAC,IAAI,CAAI,IAAI,qBAAgB,UAAU,CAAC,GAAG,SAAI,UAAU,CAAC,UAAU,UAAO,CAAC;AACvF,UAAI,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,EAC5B,SAAS,CAAC,IAAI,CAAI,IAAI,mBAAc,UAAU,CAAC,GAAG,SAAI,UAAU,CAAC,QAAQ,UAAO,CAAC;AACnF,UAAI,KAAK,CAAC,UAAU,CAAC,SAAS,CAAC,EAC7B,SAAS,CAAC,IAAI,CAAI,IAAI,oBAAe,UAAU,CAAC,GAAG,SAAI,UAAU,CAAC,SAAS,UAAO,CAAC;AACrF,UAAI,KAAK,CAAC,UAAU,CAAC,SAAS,CAAC,EAC7B,SAAS,CAAC,IAAI,CAAI,IAAI,oBAAe,UAAU,CAAC,GAAG,SAAI,UAAU,CAAC,SAAS,UAAO,CAAC;;AAErF,UAAI,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,KAAK,CAAC,UAAU,CAAC,SAAS,CAAC,EACvD,SAAS,CAAC,IAAI,CAAI,IAAI,cAAS,UAAU,CAAC,GAAG,SAAI,UAAU,CAAC,IAAI,SAAI,UAAU,CAAC,SAAS,UAAO,CAAC;;AAElG,UAAI,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,EACxB,SAAS,CAAC,IAAI,CAAI,IAAI,cAAS,UAAU,CAAC,GAAG,SAAI,UAAU,CAAC,IAAI,UAAO,CAAC;;AAE1E,UAAI,KAAK,CAAC,UAAU,CAAC,UAAU,CAAC,EAC9B,SAAS,CAAC,IAAI,CAAI,IAAI,qBAAgB,UAAU,CAAC,GAAG,SAAI,UAAU,CAAC,UAAU,UAAO,CAAC;;AAEvF,eAAS,CAAC,IAAI,CAAI,IAAI,iBAAY,UAAU,CAAC,GAAG,kBAAe,CAAC;KACjE;;AAED,UAAM,CAAC,MAAM,CAAC,MAAM,EAAE,CACnB,GAAG,CAAC,SAAS,CAAC,CACd,KAAK,EAAE,CACP,EAAE,CAAC,UAAU,EAAE,UAAU,KAAK,EAAE;AACjC,sBAAgB,CAAC,KAAK,CAAC,IAAI,EAAE,UAAU,CAAC,KAAK,EAAE,UAAU,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;KAC7E,CAAC,CAAC;GAEJ,CAAC,CAAC;CAGJ,CAAA,EAAG,CAAC","file":"src/Game/GameDrawHero.js","sourcesContent":["/*\n\nA-RPG Game, Built using JavaScript ES6\nCopyright (C) 2015 qhduan(http://qhduan.com)\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n*/\n\n\n(function () {\n  \"use strict\";\n\n  // 合并图片\n  // 把images中的所有图片按顺序draw到一个canvas上面，然后用canvas.toDataURL返回一张叠好的图片\n  function CombineHeroImage (images, width, height, callback) {\n    let canvas = document.createElement(\"canvas\");\n    canvas.height = height;\n    canvas.width = width;\n    let context = canvas.getContext(\"2d\");\n    context.clearRect(0, 0, width, height);\n\n    let length = images.length - 1; // 最后一张图是武器\n    for (let i = 0; i < length; i++) {\n      let img = images[i];\n      context.drawImage(\n        img, 0, 0, img.width, img.height,\n        0, 0, width, height\n      );\n    }\n\n    let withoutWeapon = new Image();\n    withoutWeapon.src = canvas.toDataURL(\"image/png\");\n\n    context.drawImage(\n      images[length], 0, 0, images[length].width, images[length].height,\n      0, 0, width, height\n    );\n\n    let withWeapon = new Image();\n    withWeapon.src = canvas.toDataURL(\"image/png\");\n\n    callback([withoutWeapon, withWeapon]);\n  }\n\n  // 把多张图片合成一张，并返回\n  Game.assign(\"drawHero\", function (heroCustom, callback) {\n\n    function Check (str) {\n      if (typeof str == \"string\" && str.length > 0)\n        return true;\n      return false;\n    }\n\n    let BASE = \"hero\";\n    let imageUrls = [];\n\n    if (Check(heroCustom.sex) && Check(heroCustom.body)) {\n      // 必须按顺序\n      // 身体\n      imageUrls.push(`${BASE}/body/${heroCustom.sex}/${heroCustom.body}.png`);\n      // 眼睛\n      if (Check(heroCustom.eyes))\n        imageUrls.push(`${BASE}/body/${heroCustom.sex}/eyes/${heroCustom.eyes}.png`);\n      // 衣服\n      if (Check(heroCustom.shirts))\n        imageUrls.push(`${BASE}/shirts/${heroCustom.sex}/${heroCustom.shirts}.png`);\n      if (Check(heroCustom.pants))\n        imageUrls.push(`${BASE}/pants/${heroCustom.sex}/${heroCustom.pants}.png`);\n      if (Check(heroCustom.shoes))\n      // 盔甲\n        imageUrls.push(`${BASE}/shoes/${heroCustom.sex}/${heroCustom.shoes}.png`);\n      if (Check(heroCustom.armorchest))\n        imageUrls.push(`${BASE}/armor/chest/${heroCustom.sex}/${heroCustom.armorchest}.png`);\n      if (Check(heroCustom.armorarm))\n        imageUrls.push(`${BASE}/armor/arm/${heroCustom.sex}/${heroCustom.armorarm}.png`);\n      if (Check(heroCustom.armorlegs))\n        imageUrls.push(`${BASE}/armor/legs/${heroCustom.sex}/${heroCustom.armorlegs}.png`);\n      if (Check(heroCustom.armorfeet))\n        imageUrls.push(`${BASE}/armor/feet/${heroCustom.sex}/${heroCustom.armorfeet}.png`);\n      // 头发\n      if (Check(heroCustom.hair) && Check(heroCustom.haircolor))\n        imageUrls.push(`${BASE}/hair/${heroCustom.sex}/${heroCustom.hair}/${heroCustom.haircolor}.png`);\n      // 头\n      if (Check(heroCustom.head))\n        imageUrls.push(`${BASE}/head/${heroCustom.sex}/${heroCustom.head}.png`);\n      // 头盔\n      if (Check(heroCustom.armorhelms))\n        imageUrls.push(`${BASE}/armor/helms/${heroCustom.sex}/${heroCustom.armorhelms}.png`);\n      // 武器（包括所有武器）\n      imageUrls.push(`${BASE}/weapons/${heroCustom.sex}/weapons.png`);\n    }\n\n    Sprite.Loader.create()\n      .add(imageUrls)\n      .start()\n      .on(\"complete\", function (event) {\n      CombineHeroImage(event.data, heroCustom.width, heroCustom.height, callback);\n    });\n\n  });\n\n\n})();\n"]}