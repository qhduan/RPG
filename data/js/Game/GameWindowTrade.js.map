{"version":3,"sources":["src/Game/GameWindowTrade.js"],"names":[],"mappings":"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","file":"src/Game/GameWindowTrade.js","sourcesContent":["/*\n\nA-RPG Game, Built using JavaScript ES6\nCopyright (C) 2015 qhduan(http://qhduan.com)\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n*/\n\n(function () {\n  \"use strict\";\n\n  let win = Game.Window.create(\"trade\");\n\n  win.html = `\n    <div class=\"window-box\">\n      <div id=\"tradeWindowItemBar\">\n        <button id=\"tradeWindowClose\" class=\"brownButton\">关闭</button>\n        <button id=\"tradeWindowAll\" class=\"brownButton\">全部</button>\n        <button id=\"tradeWindowWeapon\" class=\"brownButton\">武器</button>\n        <button id=\"tradeWindowArmor\" class=\"brownButton\">护甲</button>\n        <button id=\"tradeWindowPotion\" class=\"brownButton\">药水</button>\n        <button id=\"tradeWindowMaterial\" class=\"brownButton\">材料</button>\n        <button id=\"tradeWindowBook\" class=\"brownButton\">书籍</button>\n        <button id=\"tradeWindowMisc\" class=\"brownButton\">其他</button>\n      </div>\n\n      <span id=\"tradeWindowGold\"></span>\n\n      <table style=\"width: 720px; height: 320px;\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\n        <tbody>\n          <tr>\n            <td style=\"vertical-align: top;\">\n              <div style=\"width: 355px; overflow-y: auto;\">\n                <table style=\"width: 100%;\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\n                  <thead>\n                    <tr>\n                      <td style=\"width: 40px;\"></td>\n                      <td></td>\n                      <td style=\"width: 30px;\"></td>\n                      <td style=\"width: 60px;\"></td>\n                    </tr>\n                  </thead>\n                  <tbody id=\"tradeWindowTable\">\n                  </tbody>\n                </table>\n              </div>\n            </td>\n            <td style=\"vertical-align: top;\">\n              <div style=\"width: 355px; overflow-y: auto;\">\n                <table style=\"width: 100%;\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\n                  <thead>\n                    <tr>\n                      <td style=\"width: 40px;\"></td>\n                      <td></td>\n                      <td style=\"width: 30px;\"></td>\n                      <td style=\"width: 30px;\"></td>\n                      <td style=\"width: 60px;\"></td>\n                    </tr>\n                  </thead>\n                  <tbody id=\"tradeWindowHero\">\n                  </tbody>\n                </table>\n              </div>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  `;\n\n  win.css = `\n    #tradeWindowItemBar > button {\n      width: 60px;\n      height: 40px;\n      font-size: 16px;\n      margin-left: 5px;\n      margin-right: 5px;\n      margin-top: 0px;\n      margin-bottom: 5px;\n    }\n\n    #tradeWindowClose {\n      float: right;\n    }\n\n    #tradeWindowTable button, #tradeWindowHero button {\n      width: 60px;\n      height: 40px;\n      font-size: 16px;\n    }\n\n    #tradeWindowGold {\n      position: absolute;\n      right: 30px;\n      bottom: 5px;\n      font-size: 20px;\n      color: gold;\n    }\n  `;\n\n  var tradeWindowClose = document.querySelector(\"button#tradeWindowClose\");\n\n  var tradeWindowAll = document.querySelector(\"button#tradeWindowAll\");\n  var tradeWindowWeapon = document.querySelector(\"button#tradeWindowWeapon\");\n  var tradeWindowArmor = document.querySelector(\"button#tradeWindowArmor\");\n  var tradeWindowPotion = document.querySelector(\"button#tradeWindowPotion\");\n  var tradeWindowMaterial = document.querySelector(\"button#tradeWindowMaterial\");\n  var tradeWindowBook = document.querySelector(\"button#tradeWindowBook\");\n  var tradeWindowMisc = document.querySelector(\"button#tradeWindowMisc\");\n\n  var tradeWindowGold = document.querySelector(\"span#tradeWindowGold\");\n\n  tradeWindowClose.addEventListener(\"click\", function () {\n    Game.windows.trade.hide();\n  });\n\n  var lastItems = null;\n\n  tradeWindowAll.addEventListener(\"click\", function (event) {\n    Game.windows.trade.execute(\"trade\", lastItems, null);\n  });\n\n  tradeWindowWeapon.addEventListener(\"click\", function (event) {\n      Game.windows.trade.execute(\"trade\", lastItems, \"sword|spear|bow\");\n  });\n\n  tradeWindowArmor.addEventListener(\"click\", function (event) {\n    Game.windows.trade.execute(\"trade\", lastItems, \"head|body|feet\");\n  });\n\n  tradeWindowPotion.addEventListener(\"click\", function (event) {\n      Game.windows.trade.execute(\"trade\", lastItems, \"potion\");\n  });\n\n  tradeWindowMaterial.addEventListener(\"click\", function (event) {\n    Game.windows.trade.execute(\"trade\", lastItems, \"material\");\n  });\n\n  tradeWindowBook.addEventListener(\"click\", function (event) {\n    Game.windows.trade.execute(\"trade\", lastItems, \"book|scroll|letter\");\n  });\n\n  tradeWindowMisc.addEventListener(\"click\", function (event) {\n    Game.windows.trade.execute(\"trade\", lastItems, \"misc\");\n  });\n\n  win.register(\"trade\", function (items, filter) {\n\n    lastItems = items;\n\n    tradeWindowGold.textContent = Game.hero.data.gold + \"G\";\n\n    var defaultColor = \"white\";\n    var activeColor = \"yellow\";\n\n    tradeWindowAll.style.color = defaultColor;\n    tradeWindowWeapon.style.color = defaultColor;\n    tradeWindowArmor.style.color = defaultColor;\n    tradeWindowPotion.style.color = defaultColor;\n    tradeWindowMaterial.style.color = defaultColor;\n    tradeWindowBook.style.color = defaultColor;\n    tradeWindowMisc.style.color = defaultColor;\n\n    if (filter == null) {\n      tradeWindowAll.style.color = activeColor;\n    } else if (filter.match(/sword/)) {\n      tradeWindowWeapon.style.color = activeColor;\n    } else if (filter.match(/head/)) {\n      tradeWindowArmor.style.color = activeColor;\n    } else if (filter.match(/potion/)) {\n      tradeWindowPotion.style.color = activeColor;\n    } else if (filter.match(/material/)) {\n      tradeWindowMaterial.style.color = activeColor;\n    } else if (filter.match(/book/)) {\n      tradeWindowBook.style.color = activeColor;\n    } else if (filter.match(/misc/)) {\n      tradeWindowMisc.style.color = activeColor;\n    }\n\n    var tradeTable = document.getElementById(\"tradeWindowTable\");\n    var tradeHeroTable = document.getElementById(\"tradeWindowHero\");\n\n    while (tradeTable.hasChildNodes()) {\n      tradeTable.removeChild(tradeTable.lastChild);\n    }\n\n    while (tradeHeroTable.hasChildNodes()) {\n      tradeHeroTable.removeChild(tradeHeroTable.lastChild);\n    }\n\n    items.forEach(function (itemId) {\n      var item = Game.items[itemId];\n\n      if (filter && filter.indexOf(item.data.type) == -1)\n        return;\n\n      var line = document.createElement(\"tr\");\n\n      var icon = document.createElement(\"td\");\n      icon.appendChild(item.icon.cloneNode());\n      line.appendChild(icon);\n\n      var name = document.createElement(\"td\");\n      name.textContent = item.data.name;\n      line.appendChild(name);\n\n      var value = document.createElement(\"td\");\n      value.textContent = item.data.value + \"G\";\n      value.style.textAlign = \"center\";\n      value.style.color = \"gold\";\n      line.appendChild(value);\n\n      var buy = document.createElement(\"td\");\n      var buyButton = document.createElement(\"button\");\n      buyButton.textContent = \"买入\";\n      buy.appendChild(buyButton);\n      line.appendChild(buy);\n\n      buyButton.classList.add(\"brownButton\");\n\n      if (item.data.value > Game.hero.data.gold) {\n        buyButton.disabled = true;\n        buyButton.style.opacity = 0.3;\n      } else {\n        buyButton.addEventListener(\"click\", function () {\n          Game.hero.data.gold -= item.data.value;\n          if (Game.hero.data.items[itemId]) {\n            Game.hero.data.items[itemId]++;\n          } else {\n            Game.hero.data.items[itemId] = 1;\n          }\n          Game.windows.trade.execute(\"trade\", items, filter);\n        });\n      }\n\n      tradeTable.appendChild(line);\n    });\n\n    Sprite.each(Game.hero.data.items, function (itemCount, itemId) {\n      var item = Game.items[itemId];\n\n      if (filter && filter.indexOf(item.data.type) == -1)\n        return;\n\n      var line = document.createElement(\"tr\");\n\n      var icon = document.createElement(\"td\");\n      icon.appendChild(item.icon.cloneNode());\n      line.appendChild(icon);\n\n      var name = document.createElement(\"td\");\n      name.textContent = item.data.name;\n      line.appendChild(name);\n\n      var count = document.createElement(\"td\");\n      count.textContent = itemCount;\n      count.style.textAlign = \"center\";\n      line.appendChild(count);\n\n      var value = document.createElement(\"td\");\n      value.textContent = item.data.value + \"G\";\n      value.style.textAlign = \"center\";\n      value.style.color = \"gold\";\n      line.appendChild(value);\n\n      var sell = document.createElement(\"td\");\n      var sellButton = document.createElement(\"button\");\n      sellButton.textContent = \"卖出\";\n      sell.appendChild(sellButton);\n      line.appendChild(sell);\n\n      sellButton.classList.add(\"brownButton\");\n\n      sellButton.addEventListener(\"click\", function () {\n        if (itemCount == 1) {\n          Game.hero.data.bar.forEach(function (element, index, array) {\n            if (element && element.id == itemId) {\n              array[index] = null;\n            }\n          });\n          Sprite.each(Game.hero.data.equipment, function (element, key) {\n            if (element == itemId) {\n              Game.hero.data.equipment[key] = null;\n            }\n          });\n          delete Game.hero.data.items[itemId];\n        } else {\n          Game.hero.data.items[itemId]--;\n        }\n        Game.hero.data.gold += item.data.value;\n        Game.windows.interface.execute(\"refresh\");\n        Game.windows.trade.execute(\"trade\", items, filter);\n      });\n\n      tradeHeroTable.appendChild(line);\n    });\n\n    Game.windows.trade.show();\n  });\n\n}());\n"]}