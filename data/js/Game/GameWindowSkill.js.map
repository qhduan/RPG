{"version":3,"sources":["src/Game/GameWindowSkill.js"],"names":[],"mappings":"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","file":"src/Game/GameWindowSkill.js","sourcesContent":["/*\n\nA-RPG Game, Built using JavaScript ES6\nCopyright (C) 2015 qhduan(http://qhduan.com)\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n*/\n\n(function () {\n  \"use strict\";\n\n  let win = Game.Window.create(\"skill\");\n\n  win.html = `\n    <div class=\"window-box\">\n      <div id=\"skillWindowItemBar\">\n        <button id=\"skillWindowClose\" class=\"brownButton\">关闭</button>\n      </div>\n      <table border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\n        <thead>\n          <tr>\n            <td style=\"width: 40px;\"></td>\n            <td style=\"width: 120px;\"></td>\n            <td></td>\n            <td style=\"width: 60px;\"></td>\n          </tr>\n        </thead>\n        <tbody id=\"skillWindowTable\"></tbody>\n      </table>\n    </div>\n  `;\n\n  win.css = `\n    #skillWindow table {\n      width: 100%;\n    }\n\n    #skillWindow table img {\n      width: 100%;\n      height: 100%;\n    }\n\n    #skillWindow button {\n      width: 60px;\n      height: 40px;\n      font-size: 16px;\n    }\n\n    #skillWindowItemBar button {\n      width: 60px;\n      height: 40px;\n      font-size: 16px;\n      margin-left: 5px;\n      margin-right: 5px;\n      margin-top: 0px;\n      margin-bottom: 5px;\n    }\n\n    #skillWindowClose {\n      float: right;\n    }\n  `;\n\n  var skillWindowClose = document.querySelector(\"button#skillWindowClose\");\n\n  skillWindowClose.addEventListener(\"click\", function (event) {\n    Game.windows.skill.hide();\n  });\n\n  Sprite.Input.whenUp([\"esc\"], function (key) {\n    if (Game.windows.skill.showing) {\n      skillWindowClose.click();\n    }\n  });\n\n  win.register(\"open\", function () {\n    var tableBody = document.querySelector(\"tbody#skillWindowTable\");\n    while (tableBody.hasChildNodes()) {\n      tableBody.removeChild(tableBody.lastChild);\n    }\n\n    for (let i = 0; i < Game.hero.data.skillcount; i++) {\n      (function (index) {\n        var line = document.createElement(\"tr\");\n\n        var icon = document.createElement(\"td\");\n        line.appendChild(icon);\n\n        var name = document.createElement(\"td\");\n        line.appendChild(name);\n\n        var description = document.createElement(\"td\");\n        line.appendChild(description);\n\n        var manage = document.createElement(\"td\");\n        line.appendChild(manage);\n\n        var skillId = Game.hero.data.skills[index];\n        if (skillId) {\n          var skill = Game.skills[skillId];\n          icon.appendChild(skill.icon);\n          name.textContent = skill.data.name;\n          description.textContent = skill.data.description;\n\n          var manageButton = document.createElement(\"button\");\n          manageButton.textContent = \"操作\";\n          manage.appendChild(manageButton);\n\n          manageButton.classList.add(\"brownButton\");\n\n          manageButton.addEventListener(\"click\", function () {\n            Game.choice({\n              \"快捷栏\": \"shortcut\",\n              \"升级\": \"levelup\",\n              \"遗忘\": \"remove\"\n            }, function (choice) {\n              switch(choice) {\n                case \"shortcut\":\n                  Game.choice({\n                    1:0,\n                    2:1,\n                    3:2,\n                    4:3,\n                    5:4,\n                    6:5,\n                    7:6,\n                    8:7\n                  }, function (choice) {\n                    if (typeof choice == \"number\" && choice >= 0) {\n                      Game.hero.data.bar[choice] = {\n                        id: skillId,\n                        type: \"skill\"\n                      };\n                      Game.windows.interface.execute(\"refresh\");\n                    }\n                  });\n                  break;\n                case \"levelup\":\n                  if (skill.data.next && skill.data.exp && Game.hero.data.exp > skill.data.exp) {\n                    // level up\n                  }\n                  break;\n                case \"remove\":\n                  Game.confirm(`真的要遗忘 ${skill.data.name} 技能吗？`, function (yes) {\n                    if (yes) {\n                      Game.hero.data.bar.forEach(function (element, index, array) {\n                        if (element && element.id == skillId) {\n                          array[index] = null;\n                        }\n                      });\n                      Game.hero.data.skills.splice(index, 1);\n                      Game.windows.interface.execute(\"refresh\");\n                      Game.windows.skill.execute(\"open\");\n                    }\n                  });\n                  break;\n              }\n            });\n          });\n        } else {\n          name.textContent = \"空\";\n        }\n\n        tableBody.appendChild(line);\n      })(i);\n    }\n\n    Game.windows.skill.show();\n  });\n\n}());\n"]}