{"version":3,"sources":["src/Sprite/SpriteWebgl0.js"],"names":[],"mappings":"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","file":"src/Sprite/SpriteWebgl0.js","sourcesContent":["/*\n\n2D Game Sprite Library, Built using JavaScript ES6\nCopyright (C) 2015 qhduan(http://qhduan.com)\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n*/\n\n/**\n * @fileoverview Define the Sprite.Webgl, a renderer, other choice from Sprite.Canvas\n * @author mail@qhduan.com (QH Duan)\n */\n\n\n(function () {\n \"use strict\";\n\n  let internal = Sprite.Namespace();\n\n  /**\n    Use mediump precision in WebGL when possible\n    Highp in fragment shaders is an optional part of the OpenGL ES 2.0 spec,\n    so not all hardware supports it\n    https://developers.google.com/web/updates/2011/12/Use-mediump-precision-in-WebGL-when-possible?hl=en\n  */\n\n  var bufferCache = {};\n  window.bbb = bufferCache;\n  function getBuffer (a,b,c,d) {\n    if (bufferCache[a] && bufferCache[a][b] && bufferCache[a][b][c]) {\n      return bufferCache[a][b][c][d];\n    }\n  }\n  function setBuffer (a,b,c,d,v) {\n    if (!bufferCache[a]) {\n      bufferCache[a] = {};\n    }\n    if (!bufferCache[a][b]) {\n      bufferCache[a][b] = {};\n    }\n    if (!bufferCache[a][b][c]) {\n      bufferCache[a][b][c] = {};\n    }\n    bufferCache[a][b][c][d] = v;\n  }\n\n  let vertexShaderSrc = `\n  precision lowp float; // mediump highp\n  attribute vec2 a_texCoord;\n  varying vec2 texCoord;\n\n  attribute vec2 aVertex;\n  uniform vec2 resolution;\n\n  uniform vec4 position;\n\n  void main(void) {\n     vec2 a = aVertex * (position.zw / resolution) + (position.xy / resolution);\n     a = a * 2.0 - 1.0;\n\n     gl_Position = vec4(a * vec2(1.0, -1.0), 0.0, 1.0);\n     texCoord = a_texCoord;\n  }`;\n\n  // brightness and contrast's formular from https://github.com/evanw/glfx.js\n  let fragmentShaderSrc = `\n  precision lowp float; // mediump highp\n\n  uniform vec4 crop;\n  uniform float brightness;\n  uniform float alpha;\n  uniform float contrast;\n\n  uniform sampler2D image;\n\n  // the texCoords passed in from the vertex shader.\n  varying vec2 texCoord;\n\n  void main(void) {\n\n     vec4 color = texture2D(\n       image,\n       vec2(texCoord.x * crop.z, texCoord.y * crop.w) + crop.xy\n     ).rgba;\n\n     if (contrast > 0.0) {\n       color.xyz = (color.xyz - 0.5) / (1.0 - contrast) + 0.5;\n     } else {\n       color.xyz = (color.xyz - 0.5) * (1.0 + contrast) + 0.5;\n     }\n\n     color.xyz = color.xyz + brightness;\n     color.a = color.a * alpha;\n\n     gl_FragColor = color;\n  }`;\n\n  function setRectangle(gl, x, y, width, height) {\n    let x2 = x + width;\n    let y2 = y + height;\n    let bufferData = new Float32Array(\n      [\n        x, y,\n        x2, y,\n        x, y2,\n        x, y2,\n        x2, y,\n        x2, y2\n      ]\n    );\n    gl.bufferData(gl.ARRAY_BUFFER,\n      bufferData,\n      gl.STATIC_DRAW\n    );\n    return bufferData;\n  }\n\n  /**\n   * Test a value is power of 2 or not, eg. 2 is true, 2048 is ture, 2000 is false\n   * @param {number} value The number to check\n   * @return {boolean} Whether or not the input number is power of 2\n   */\n  function isPOT (value) {\n    return value > 0 && ((value - 1) & value) === 0;\n  }\n\n  /**\n   * Renderer using webgl\n   * @class\n   */\n  Sprite.assign(\"Webgl\", class SpriteWebgl {\n\n    /**\n     * @static\n     * @return {boolean} The browser whether or not support WebGL\n     */\n    static support () {\n      let canvas = document.createElement(\"canvas\");\n      let gl = canvas.getContext(\"webgl\")\n        || canvas.getContext(\"experimental-webgl\");\n      if (gl) {\n        return true;\n      }\n      return false;\n    }\n\n    /**\n     * Construct a renderer width certain width and height\n     * @constructor\n     */\n    constructor (width, height) {\n      let privates = internal(this);\n      let canvas = document.createElement(\"canvas\");\n      canvas.width = width || 640;\n      canvas.height = height || 480;\n\n      privates.color = [0, 0, 0];\n      privates.filter = new Map();\n      privates.textureCache = new Map();\n      privates.canvas = canvas;\n\n      let gl = privates.gl = canvas.getContext(\"webgl\") || canvas.getContext(\"experimental-webgl\");\n      privates.maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);\n\n      if (!gl) {\n        throw new Error(\"Sprite.Webgl webgl is not supported\");\n      }\n\n      gl.viewport(0, 0, canvas.width, canvas.height);\n\n      let vertShaderObj = gl.createShader(gl.VERTEX_SHADER);\n      let fragShaderObj = gl.createShader(gl.FRAGMENT_SHADER);\n      gl.shaderSource(vertShaderObj, vertexShaderSrc);\n      gl.shaderSource(fragShaderObj, fragmentShaderSrc);\n      gl.compileShader(vertShaderObj);\n      gl.compileShader(fragShaderObj);\n\n      let program = gl.createProgram();\n      gl.attachShader(program, vertShaderObj);\n      gl.attachShader(program, fragShaderObj);\n\n      gl.linkProgram(program);\n      gl.useProgram(program);\n\n      gl.cullFace(gl.BACK);\n      gl.frontFace(gl.CW);\n      gl.enable(gl.CULL_FACE);\n      gl.enable(gl.BLEND);\n      gl.disable(gl.DEPTH_TEST);\n      gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n\n      privates.cropLoc = gl.getUniformLocation(program, \"crop\");\n      privates.brightnessLoc = gl.getUniformLocation(program, \"brightness\");\n      privates.contrastLoc = gl.getUniformLocation(program, \"contrast\");\n      privates.alphaLoc = gl.getUniformLocation(program, \"alpha\");\n      privates.resolutionLoc = gl.getUniformLocation(program, \"resolution\");\n      gl.uniform2f(privates.resolutionLoc, canvas.width, canvas.height);\n\n      privates.positionLoc = gl.getUniformLocation(program, \"position\");\n\n\n      privates.tLoc = gl.getAttribLocation(program, \"a_texCoord\");\n      gl.enableVertexAttribArray(privates.tLoc);\n      privates.texCoordBuffer = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, privates.texCoordBuffer);\n      gl.vertexAttribPointer(privates.tLoc, 2, gl.FLOAT, false, 0, 0);\n      gl.bufferData(gl.ARRAY_BUFFER,\n        new Float32Array(\n          [\n            0, 1,\n            0, 0,\n            1, 0,\n            1, 1\n          ]\n        ),\n        gl.STATIC_DRAW\n      );\n\n      privates.vLoc = gl.getAttribLocation(program, \"aVertex\");\n      gl.enableVertexAttribArray(privates.vLoc);\n      privates.vertexBuff = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, privates.vertexBuff);\n      gl.bufferData(\n        gl.ARRAY_BUFFER,\n        new Float32Array([\n          0, 1,\n          0, 0,\n          1, 0,\n          1, 1\n        ]),\n        gl.STATIC_DRAW\n      );\n      gl.enableVertexAttribArray(privates.vLoc);\n      gl.vertexAttribPointer(privates.vLoc, 2, gl.FLOAT, false, 0, 0);\n\n      privates.currentTexture = null;\n\n\n      this.filter(\"brightness\", 0);\n      this.filter(\"contrast\", 0);\n      this.alpha = 1;\n\n      console.log(\"webgl inited. max texture size: %d\",\n        gl.getParameter(gl.MAX_TEXTURE_SIZE));\n    }\n\n    drawImage9 (image, sx, sy, sw, sh, dx, dy, dw, dh) {\n      let privates = internal(this);\n      let gl = privates.gl;\n\n      let texture = this.createTexture(gl, image);\n      if (privates.currentTexture != texture) {\n        gl.activeTexture(gl.TEXTURE0);\n        gl.bindTexture(gl.TEXTURE_2D, texture);\n        privates.currentTexture = texture;\n      }\n\n      gl.uniform4f(privates.cropLoc,\n        sx/image.width, sy/image.height, sw/image.width, sh/image.height);\n      gl.uniform4f(privates.positionLoc, dx, dy, dw, dh);\n\n      gl.drawArrays(gl.TRIANGLE_FAN, 0, 4);\n    }\n\n    createTexture (gl, image) {\n      let privates = internal(this);\n      if (privates.textureCache.has(image)) {\n        return privates.textureCache.get(image);\n      } else {\n        let texture = gl.createTexture();\n        gl.bindTexture(gl.TEXTURE_2D, texture);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n        gl.texImage2D(gl.TEXTURE_2D, 0,  gl.RGBA,  gl.RGBA, gl.UNSIGNED_BYTE, image);\n        gl.bindTexture(gl.TEXTURE_2D, null);\n        privates.textureCache.set(image, texture);\n        return texture;\n      }\n    }\n\n    drawImage (image, sx, sy, sw, sh, dx, dy, dw, dh) {\n      if (arguments.length == 9) {\n        // all right\n      } else if (arguments.length == 5) {\n        // drawImage (image, dx, dy, dw, dh);\n        dx = sx;\n        dy = sy;\n        dw = sw;\n        dh = sh;\n        sx = 0;\n        sy = 0;\n        sw = image.width;\n        sh = image.height;\n      } else if (arguments.length == 3) {\n        // drawImage (image, dx, dy);\n        dx = sx;\n        dy = sy;\n        dw = image.width;\n        dh = image.height;\n        sx = 0;\n        sy = 0;\n        sw = image.width;\n        sh = image.height;\n      } else {\n        console.error(arguments, this);\n        throw new Error(\"Sprite.Webgl.drawImage invalid arguments\");\n      }\n\n      /*\n      if (dx > this.width || dy > this.height) {\n        return;\n      }\n\n      if ((dx + dw) < 0 || (dy + dh) < 0) {\n        return;\n      }\n\n      if (\n        !Number.isInteger(image.width) ||\n        !Number.isInteger(image.height) ||\n        image.width <= 0 ||\n        image.height <= 0 ||\n        image.width > privates.maxTextureSize ||\n        image.height > privates.maxTextureSize\n      ) {\n        console.error(image, privates, this);\n        throw new Error(\"Sprite.Webgl.drawImage invalid image\");\n      }\n      */\n\n      this.drawImage9(image, sx, sy, sw, sh, dx, dy, dw, dh);\n    }\n\n    get alpha () {\n      let privates = internal(this);\n      return privates.alpha;\n    }\n\n    set alpha (value) {\n      let privates = internal(this);\n      let gl = privates.gl;\n      if (typeof value == \"number\" &&\n        !isNaN(value) &&\n        value >= 0 &&\n        value <= 1\n      ) {\n        if (value != privates.alpha) {\n          privates.alpha = value;\n          gl.uniform1f(privates.alphaLoc, privates.alpha);\n        }\n      } else {\n        console.error(value, this);\n        throw new Error(\"Sprite.Webgl got invalid alpha number\");\n      }\n    }\n\n    /**\n     * @return {string} The color, eg \"#00ff00\"\n     */\n    get color () {\n      let privates = internal(this);\n      let color = privates.color;\n      let r = color[0].toString(16);\n      let g = color[1].toString(16);\n      let b = color[2].toString(16);\n      if (r.length < 2) r = \"0\" + r;\n      if (g.length < 2) g = \"0\" + g;\n      if (b.length < 2) b = \"0\" + b;\n      return \"#\" + r + g + b;\n    }\n    /**\n     * @param {string} value The new color, eg \"#00ff00\"\n     */\n    set color (value) {\n      let privates = internal(this);\n      let m = value.match(/^#([\\da-fA-F][\\da-fA-F])([\\da-fA-F][\\da-fA-F])([\\da-fA-F][\\da-fA-F])$/);\n      if (m) {\n        let r = m[1];\n        let g = m[2];\n        let b = m[3];\n        privates.color[0] = parseInt(r, 16);\n        privates.color[1] = parseInt(g, 16);\n        privates.color[2] = parseInt(b, 16);\n      } else {\n        console.error(value, this);\n        throw new Error(\"Sprite.Webgl.color invalid color format\");\n      }\n    }\n\n    /**\n     * @param {string} name The name of filter you want get or set\n     * @param {number} value Number or undefined, if undefined ,return current value\n     */\n    filter (name, value) {\n      let privates = internal(this);\n      let gl = privates.gl;\n      if (typeof value == \"number\") {\n        privates.filter.set(name, value);\n        gl.uniform1f(privates.brightnessLoc, privates.filter.get(\"brightness\"));\n        gl.uniform1f(privates.contrastLoc, privates.filter.get(\"contrast\"));\n      } else {\n        return privates.get(name);\n      }\n    }\n\n    clear () {\n      let privates = internal(this);\n      let gl = privates.gl;\n      let color = privates.color;\n      gl.clearColor(color[0], color[1], color[2], 1); // black\n      gl.clear(gl.COLOR_BUFFER_BIT);\n    }\n\n    get width () {\n      let privates = internal(this);\n      return privates.canvas.width;\n    }\n\n    set width (value) {\n      let privates = internal(this);\n      if (typeof value == \"number\" &&\n        !isNaN(value) &&\n        value > 0 &&\n        value <= 4096\n      ) {\n        if (value != privates.canvas.width) {\n          privates.canvas.width = value;\n          privates.gl.viewport(0, 0, privates.canvas.width, privates.canvas.height);\n          privates.gl.uniform2f(\n            privates.resolutionLoc,\n            privates.canvas.width,\n            privates.canvas.height\n          );\n        }\n      } else {\n        console.error(value, this);\n        throw new Error(\"Sprite.Webgl got invalid width number\");\n      }\n    }\n\n    get height () {\n      let privates = internal(this);\n      return privates.canvas.height;\n    }\n\n    set height (value) {\n      let privates = internal(this);\n      if (typeof value == \"number\" &&\n        !isNaN(value) &&\n        value > 0 &&\n        value <= 4096\n      ) {\n        if (value != privates.canvas.height) {\n          privates.canvas.height = value;\n          privates.gl.viewport(0, 0, privates.canvas.width, privates.canvas.height);\n          privates.gl.uniform2f(resolutionLoc, privates.canvas.width, privates.canvas.height);\n        }\n      } else {\n        console.error(value, this);\n        throw new Error(\"Sprite.Webgl got invalid height number\");\n      }\n    }\n\n    get canvas () {\n      let privates = internal(this);\n      return privates.canvas;\n    }\n\n    set canvas (value) {\n      console.error(value, this);\n      throw new Error(\"Sprite.Webgl.canvas cannot write\");\n    }\n\n  });\n\n\n\n})();\n"]}