{"version":3,"sources":["src/Game/GameWindowInterface.js"],"names":[],"mappings":"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","file":"src/Game/GameWindowInterface.js","sourcesContent":["/*\n\nA-RPG Game, Built using JavaScript ES6\nCopyright (C) 2015 qhduan(http://qhduan.com)\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n*/\n\n(function () {\n  \"use strict\";\n\n  let win = Game.Window.create(\"interface\");\n\n  win.html = `\n    <div id=\"interfaceWindowBar\"></div>\n\n    <div style=\"position: absolute; bottom: 10px; left: 20px; width: 100px; height: 60px;\">\n      <div style=\"width: 100px; height: 20px; margin: 5px 0; border: 1px solid gray; background-color: white;\">\n        <div id=\"interfaceWindowHP\" style=\"width: 100%; height: 100%; background-color: green;\"></div>\n      </div>\n      <div style=\"width: 100px; height: 20px; margin: 5px 0; border: 1px solid gray; background-color: white;\">\n        <div id=\"interfaceWindowSP\" style=\"width: 100%; height: 100%; background-color: blue;\"></div>\n      </div>\n    </div>\n\n    <span id=\"interfaceWindowMap\"></span>\n    <span id=\"interfaceWindowDatetime\"></span>\n\n    <button id=\"interfaceWindowUse\" class=\"interfaceWindowButton\"></button>\n    <button id=\"interfaceWindowMenu\" class=\"interfaceWindowButton\"></button>\n  `;\n\n  win.css = `\n\n    #interfaceWindowBar {\n      text-align: center;\n      position: absolute;\n      bottom: 10px;\n      width: 100%;\n      height: 60px;\n    }\n\n    #interfaceWindow {\n      /** 让interface窗口的主要窗口，不接受事件 */\n      pointer-events: none;\n    }\n\n    button.interfaceWindowButton {\n      margin-left: 3px;\n      margin-right: 3px;\n      width: 60px;\n      height: 60px;\n      border: 4px solid gray;\n      border-radius: 10px;\n      background-color: rgba(100, 100, 100, 0.5);\n      display: inline-block;\n      /** 让interface窗口的按钮，接受事件 */\n      pointer-events: auto;\n      background-repeat: no-repeat;\n      background-size: cover;\n    }\n\n    button.interfaceWindowButton:hover {\n      opacity: 0.5;\n    }\n\n    button.interfaceWindowButton > img {\n      width: 100%;\n      height: 100%;\n    }\n\n    span#interfaceWindowMap {\n      position: absolute:\n      top: 0px;\n      background-color: rgba(100, 100, 100, 0.7);\n      display: inline-block;\n    }\n\n    span#interfaceWindowDatetime {\n      position: absolute:\n      top: 200px;\n      left: 0;\n      background-color: rgba(100, 100, 100, 0.7);\n      display: inline-block;\n    }\n\n    button#interfaceWindowUse {\n      position: absolute;\n      top: 5px;\n      right: 85px;\n      visibility: hidden;\n      background-image: url(\"image/hint.png\");\n    }\n\n    button#interfaceWindowMenu {\n      position: absolute;\n      top: 5px;\n      right: 5px;\n      background-image: url(\"image/setting.png\");\n    }\n\n    button.interfaceWindowButton:disabled {\n      cursor: default;\n      pointer-events: none;\n      background-color: gray;\n      opacity: 0.5;\n    }\n  `;\n\n  let interfaceWindowUse = document.querySelector(\"button#interfaceWindowUse\");\n\n  win.assign(\"hideUse\", function () {\n    interfaceWindowUse.style.visibility = \"hidden\";\n  });\n\n  win.assign(\"showUse\", function () {\n    interfaceWindowUse.style.visibility = \"visible\";\n  });\n\n  win.on(\"active\", function () {\n    Game.start();\n  });\n\n  win.on(\"deactive\", function () {\n    Game.pause();\n  })\n\n  let interfaceWindowBar = document.querySelector(\"div#interfaceWindowBar\");\n\n  let interfaceWindowMap = document.querySelector(\"span#interfaceWindowMap\");\n  let interfaceWindowMenu = document.querySelector(\"button#interfaceWindowMenu\");\n\n  win.whenUp([\"esc\"], function (key) {\n    if (Game.windows.interface.atop) {\n      setTimeout(function () {\n        interfaceWindowMenu.click();\n      }, 20);\n    }\n  });\n\n  // 设置技能栏\n  for (let i = 0; i < 8; i++) {\n    (function (index) {\n      let button = document.createElement(\"button\");\n      button.id = `interfaceWindowButton-${index}`;\n      button.classList.add(\"interfaceWindowButton\");\n      interfaceWindowBar.appendChild(button);\n\n      let text = document.createElement(\"label\");\n      text.id = `interfaceWindowButtonText-${index}`;\n      text.style.position = \"absolute\";\n      text.style.backgroundColor = \"white\";\n      text.style.marginLeft = \"-26px\";\n      text.style.marginTop = \"12px\";\n      button.appendChild(text);\n\n      button.addEventListener(\"click\", function (event) {\n        let element = Game.hero.data.bar[index];\n        if (element) {\n          if (element.type == \"skill\")\n            Game.hero.fire(element.id);\n          else if (element.type == \"item\") {\n            let itemId = element.id;\n            let item = Game.items[itemId];\n            item.use(Game.hero);\n            Game.hero.data.items[itemId]--;\n            if (Game.hero.data.items[itemId] <= 0) {\n              delete Game.hero.data.items[itemId];\n              Game.hero.data.bar[index] = null;\n            }\n            Game.windows.interface.refresh();\n          }\n        }\n      });\n    })(i);\n  }\n\n  function SkillFire (num) {\n    let element = Game.hero.data.bar[num];\n    if (element) {\n      if (element.type == \"skill\") {\n        let cooldown = Game.hero.fire(element.id);\n        let button = document.querySelector(`#interfaceWindowButton-${num}`);\n        button.disabled = true;\n        setTimeout(function () {\n          button.disabled = false;\n        }, cooldown);\n        //button.style.disabled = \"true\";\n      } else if (element.type == \"item\") {\n\n      }\n    }\n  }\n\n  win.whenUp([\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\"], function (key) {\n    let num = parseInt(key);\n    // 只有在interface窗口是only存在的时候才使用快捷键\n    if (Number.isInteger(num) && Game.windows.interface.atop) {\n      SkillFire(num - 1);\n    }\n  });\n\n  win.whenUp([\"e\", \"E\", \"space\", \"enter\"], function (key) {\n    if (Game.windows.interface.showing) {\n      if (Game.hintObject && Game.hintObject.heroUse) {\n        Game.hintObject.heroUse();\n      }\n    }\n  });\n\n  interfaceWindowUse.addEventListener(\"click\", function (event) {\n    if (Game.hintObject && Game.hintObject.heroUse) {\n      Game.hintObject.heroUse();\n    }\n  });\n\n  let interfaceWindowHP = document.querySelector(\"#interfaceWindowHP\");\n  let interfaceWindowSP = document.querySelector(\"#interfaceWindowSP\");\n\n  win.assign(\"status\", function () {\n    if (Game.hero) {\n      let hp = Game.hero.data.hp / Game.hero.data.$hp;\n      let sp = Game.hero.data.sp / Game.hero.data.$sp;\n      interfaceWindowHP.style.width = `${hp*100}%`;\n      interfaceWindowSP.style.width = `${sp*100}%`;\n      if (hp >= 0.5) {\n        interfaceWindowHP.style.backgroundColor = \"green\";\n      } else if (hp >= 0.25) {\n        interfaceWindowHP.style.backgroundColor = \"yellow\";\n      } else {\n        interfaceWindowHP.style.backgroundColor = \"red\";\n      }\n    }\n  });\n\n  win.assign(\"datetime\", function () {\n    if (Game.hero && Game.hero.data && Number.isInteger(Game.hero.data.time)) {\n      let YEARMIN = 60*24*30*12;\n      let MONTHMIN = 60*24*30;\n      let DAYMIN = 60*24;\n      let HOURMIN = 60;\n      let datetime = document.querySelector(\"span#interfaceWindowDatetime\");\n      let time = Game.hero.data.time;\n      let year = Math.floor(time/YEARMIN);\n      time = time % YEARMIN;\n      let month = Math.floor(time/MONTHMIN);\n      time = time % MONTHMIN;\n      let day = Math.floor(time/DAYMIN);\n      time = time % DAYMIN;\n      let hour = Math.floor(time/HOURMIN);\n      time = time % HOURMIN;\n      let minute = time;\n      year++;\n      month++;\n      day++;\n      hour = hour.toString();\n      while (hour.length < 2) hour = \"0\"+hour;\n      minute = minute.toString();\n      while (minute.length < 2) minute = \"0\"+minute;\n      datetime.textContent = `帝国历${year}年${month}月${day}日 ${hour}:${minute}`;\n\n      if (hour >= 20 || hour < 4) { // 20:00 to 4:00\n        Game.stage.filter(\"brightness\", -0.15);\n      } else if (hour >= 4 && hour < 6) {\n        Game.stage.filter(\"brightness\", -0.1);\n      } else if (hour >= 6 && hour < 8) {\n        Game.stage.filter(\"brightness\", -0.05);\n      } else if (hour >= 8 && hour < 10) {\n        Game.stage.filter(\"brightness\", 0.0);\n      } else if (hour >= 10 && hour < 12) {\n        Game.stage.filter(\"brightness\", 0.05);\n      } else if (hour >= 12 && hour < 14) {\n        Game.stage.filter(\"brightness\", 0.0);\n      } else if (hour >= 14 && hour < 16) {\n        Game.stage.filter(\"brightness\", 0.0);\n      } else if (hour >= 16 && hour < 18) {\n        Game.stage.filter(\"brightness\", -0.05);\n      } else if (hour >= 18 && hour < 20) {\n        Game.stage.filter(\"brightness\", -0.1);\n      }\n\n    }\n  });\n\n  setInterval(function () {\n    if (Game.hero) {\n      Game.hero.data.time++;\n      Game.windows.interface.datetime();\n    }\n  }, 1000);\n\n  win.assign(\"refresh\", function () {\n    for (let i = 0; i < 8; i++) {\n      let element = Game.hero.data.bar[i];\n      let button = document.querySelector(`#interfaceWindowButton-${i}`);\n      let text = document.querySelector(`#interfaceWindowButtonText-${i}`);\n\n      if (element) {\n        let id = element.id;\n        let type = element.type;\n        if (type == \"skill\") {\n          let skill = Game.skills[id];\n          button.style.backgroundImage = `url(\"${skill.icon.src}\")`;\n          text.textContent = skill.data.cost;\n        } else if (type == \"item\") {\n          let item = Game.items[id];\n          button.style.backgroundImage = `url(\"${item.icon.src}\")`;\n          text.textContent = Game.hero.data.items[id];\n        }\n      } else {\n        // empty bar element\n        text.textContent = \"\";\n        button.style.backgroundImage = \"\";\n      }\n    }\n\n    interfaceWindowMap.textContent = Game.area.map.data.name;\n  });\n\n  win.on(\"beforeShow\", function () {\n    Game.windows.interface.refresh();\n  });\n\n  interfaceWindowMenu.addEventListener(\"click\", function (event) {\n    Game.windows.sysmenu.show();\n  });\n\n\n})();\n"]}